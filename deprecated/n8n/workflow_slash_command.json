{
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        664,
        -160
      ],
      "id": "a0189ef5-d1a4-412d-babb-9fa51c1edffa",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "8lPhEKPCUTIw5arX",
          "name": "[ì§€ì§€í”Œë©]30ëŒ€ì˜ì‚¶"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "discord-interaction",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -304,
        -368
      ],
      "id": "700b6fad-c907-4a29-b7d7-ecd9e9e0a4d4",
      "name": "Webhook",
      "webhookId": "e72cc8e3-8ba6-4dc4-87a8-590325463557"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": ""
          },
          "conditions": [
            {
              "leftValue": "={{ $json.body.type }}",
              "rightValue": 1,
              "operator": {
                "type": "number",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -80,
        -368
      ],
      "id": "if-ping-check",
      "name": "PING ì²´í¬"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\"type\": 1}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        144,
        -200
      ],
      "id": "respond-pong",
      "name": "PONG ì‘ë‹µ"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\"type\": 5}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        144,
        -368
      ],
      "id": "respond-deferred",
      "name": "ì²˜ë¦¬ì¤‘ ì‘ë‹µ"
    },
    {
      "parameters": {
        "jsCode": "const interaction = $('Webhook').first().json.body;\nconst user = interaction.member.user.username;\nconst url = interaction.data.options[0].value;\nconst token = interaction.token;\nconst appId = interaction.application_id;\n\nreturn [{\n  json: {\n    username: user,\n    content: url,\n    interaction_token: token,\n    application_id: appId\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        368,
        -368
      ],
      "id": "extract-interaction-data",
      "name": "ë°ì´í„° ì¶”ì¶œ"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ì‚¬ìš©ì: {{ $json.username }}\nURL: {{ $json.content }}\nì˜¤ëŠ˜ ë‚ ì§œ: {{ $now.format('YYYY-MM-DD') }}",
        "options": {
          "systemMessage": "=ë„ˆëŠ” 'ggplab'ì˜ <ì½˜í…ì¸  ì„¤ê³„ì> ì±Œë¦°ì§€ ë§¤ë‹ˆì €ì•¼.\nì‚¬ìš©ìê°€ ë³´ë‚¸ URLì„ ë³´ê³  ì•„ë˜ ê·œì¹™ì— ë”°ë¼ JSON ë°ì´í„°ë¥¼ ìƒì„±í•´.\n\n1. platform: URLì„ ë³´ê³  [LinkedIn, Instagram, Threads, YouTube, Blog] ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜.\n2. week_number: 2026-02-23(ì‹œì‘ì¼) ëŒ€ë¹„ ì˜¤ëŠ˜ì´ ëª‡ ì£¼ì°¨ì¸ì§€ ê³„ì‚° (7ì¼ ë‹¨ìœ„, ì˜¬ë¦¼).\n3. summary: URLê³¼ í”Œë«í¼ì„ ë³´ê³  ê°„ë‹¨íˆ ì¶”ì •. ì •í™•í•˜ì§€ ì•Šì•„ë„ ë¨.\n\n4. response_msg: ì‚¬ìš©ìì—ê²Œ ì¤„ ì¹œì ˆí•œ ì¹­ì°¬ ë©”ì‹œì§€.\n     - week_numberì™€ ì‚¬ìš©ì ì´ë¦„ì„ í¬í•¨í•  ê²ƒ.\n     - ë©”ì‹œì§€ ëì— ë°˜ë“œì‹œ ì›ë³¸ URLì„ ê·¸ëŒ€ë¡œ í¬í•¨í•  ê²ƒ. (Discordê°€ ìë™ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ìƒì„±í•¨)\n     - í˜•ì‹ ì˜ˆ:\n       \"âœ… {name}ë‹˜, {week}ì£¼ì°¨ ì¸ì¦ ì™„ë£Œ! ğŸ‰\\n\\n{ì›ë³¸ URL}\"\n\nê²°ê³¼ê°’ì€ ë°˜ë“œì‹œ JSON í¬ë§·ìœ¼ë¡œë§Œ ì¶œë ¥í•´.\n{\n  \"platform\": \"LinkedIn\",\n  \"week_number\": 1,\n  \"week_label\": \"1ì£¼ì°¨\",\n  \"summary\": \"n8n ìë™í™” ì‹œìŠ¤í…œ êµ¬ì¶• ê²½í—˜ ê³µìœ \",\n  \"response_msg\": \"âœ… jayjunglimë‹˜, 1ì£¼ì°¨ ì¸ì¦ ì™„ë£Œ! ğŸ‰\\n\\nhttps://linkedin.com/...\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        592,
        -368
      ],
      "id": "98c2edd0-96ba-4013-a52a-6c2f0893a50a",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "jsCode": "const raw = $input.first().json.output || $input.first().json.text || '';\nconst jsonMatch = raw.match(/\\{[\\s\\S]*\\}/);\nif (!jsonMatch) throw new Error('AI ì‘ë‹µì—ì„œ JSONì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ' + raw);\nconst parsed = JSON.parse(jsonMatch[0]);\nconst extractData = $('ë°ì´í„° ì¶”ì¶œ').first().json;\nreturn [{\n  json: {\n    date: new Date().toISOString().split('T')[0],\n    name: extractData.username || 'Unknown',\n    platform: parsed.platform,\n    url: extractData.content,\n    week: parsed.week_label,\n    summary: parsed.summary,\n    response_msg: parsed.response_msg,\n    interaction_token: extractData.interaction_token,\n    application_id: extractData.application_id\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        816,
        -368
      ],
      "id": "724610c8-1035-43c7-b991-2817b7280dea",
      "name": "AI ì‘ë‹µ íŒŒì‹±"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1CKyVexXErtbkAVm6I-30fh3tei6J4B9HtCjq0-fmvvU",
          "mode": "list",
          "cachedResultName": "log_content_challenge",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1CKyVexXErtbkAVm6I-30fh3tei6J4B9HtCjq0-fmvvU/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "ì‹œíŠ¸1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1CKyVexXErtbkAVm6I-30fh3tei6J4B9HtCjq0-fmvvU/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "date": "={{ $json.date }}",
            "user": "={{ $json.name }}",
            "platfrom": "={{ $json.platform }}",
            "link": "={{ $json.url }}",
            "number": "={{ $json.week }}",
            "summary": "={{ $json.summary }}",
            "etc": "={{ $json.response_msg }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "user",
              "displayName": "user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "platfrom",
              "displayName": "platfrom",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "link",
              "displayName": "link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "number",
              "displayName": "number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "summary",
              "displayName": "summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "etc",
              "displayName": "etc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1040,
        -368
      ],
      "id": "3561f088-165b-4542-af54-85cdc5728554",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "2MQp9C1Zxb2dnyAq",
          "name": "[ì§€ì§€í”Œë©]30ëŒ€ì˜ì‚¶"
        }
      }
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://discord.com/api/v10/webhooks/{{ $json.application_id }}/{{ $json.interaction_token }}/messages/@original",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={ \"content\": {{ JSON.stringify($json.response_msg) }} }",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.4,
      "position": [
        1264,
        -368
      ],
      "id": "http-followup",
      "name": "Discord ë‹µë³€ ì „ì†¡"
    }
  ],
  "connections": {
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "PING ì²´í¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PING ì²´í¬": {
      "main": [
        [
          {
            "node": "PONG ì‘ë‹µ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ì²˜ë¦¬ì¤‘ ì‘ë‹µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì²˜ë¦¬ì¤‘ ì‘ë‹µ": {
      "main": [
        [
          {
            "node": "ë°ì´í„° ì¶”ì¶œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ë°ì´í„° ì¶”ì¶œ": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "AI ì‘ë‹µ íŒŒì‹±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI ì‘ë‹µ íŒŒì‹±": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Discord ë‹µë³€ ì „ì†¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "a3c9c522adfd6385f845232ff4cc78161b141f603e69361658584d0ff2befbeb"
  }
}
