{
  "name": "ì½˜í…ì¸  ì„¤ê³„ì ì±Œë¦°ì§€ - ë©”ì¸ ì¸ì¦ ì›Œí¬í”Œë¡œìš°",
  "nodes": [
    {
      "parameters": {
        "event": "messageCreate",
        "filters": {
          "channelId": "={{$env.DISCORD_CHANNEL_ID}}"
        }
      },
      "id": "node_discord_trigger",
      "name": "Discord Trigger (ì±Œë¦°ì§€-ì¸ì¦ ì±„ë„)",
      "type": "n8n-nodes-base.discordTrigger",
      "typeVersion": 1,
      "position": [240, 300],
      "credentials": {
        "discordApi": { "id": "REPLACE_WITH_CREDENTIAL_ID", "name": "Discord Bot" }
      },
      "notes": "âš ï¸ ì±„ë„ IDë¥¼ í™˜ê²½ë³€ìˆ˜ ë˜ëŠ” ì§ì ‘ ì…ë ¥ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.content }}",
              "operation": "contains",
              "value2": "http"
            }
          ]
        }
      },
      "id": "node_url_check",
      "name": "URL í¬í•¨ ì—¬ë¶€ í™•ì¸",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [460, 300]
    },
    {
      "parameters": {
        "content": "={{ 'ì¸ì¦ ë§í¬ë¥¼ í¬í•¨í•´ ì£¼ì„¸ìš”! ğŸ”—\\n\\nì½˜í…ì¸  ë°œí–‰ í›„ ë§í¬ë¥¼ ë¶™ì—¬ë„£ìœ¼ë©´ ìë™ ì¸ì¦ë©ë‹ˆë‹¤.' }}",
        "channelId": "={{$env.DISCORD_CHANNEL_ID}}"
      },
      "id": "node_no_url_reply",
      "name": "URL ì—†ìŒ ì•ˆë‚´ ë©”ì‹œì§€",
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [680, 460],
      "credentials": {
        "discordApi": { "id": "REPLACE_WITH_CREDENTIAL_ID", "name": "Discord Bot" }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ì‚¬ìš©ì: {{ $json.author.username }}\nURL: {{ $json.content }}\nì˜¤ëŠ˜ ë‚ ì§œ: {{ $now.format('YYYY-MM-DD') }}",
        "options": {
          "systemMessage": "ë„ˆëŠ” 'ggplab'ì˜ <ì½˜í…ì¸  ì„¤ê³„ì> ì±Œë¦°ì§€ ë§¤ë‹ˆì €ì•¼.\nì‚¬ìš©ìê°€ ë³´ë‚¸ URLì„ ë³´ê³  ì•„ë˜ ê·œì¹™ì— ë”°ë¼ JSON ë°ì´í„°ë¥¼ ìƒì„±í•´.\n\n1. platform: URLì„ ë³´ê³  [LinkedIn, Instagram, Threads, YouTube, Blog] ì¤‘ í•˜ë‚˜ë¡œ ë¶„ë¥˜.\n2. week_number: 2026-02-23(ì‹œì‘ì¼) ëŒ€ë¹„ ì˜¤ëŠ˜ì´ ëª‡ ì£¼ì°¨ì¸ì§€ ê³„ì‚° (7ì¼ ë‹¨ìœ„, ì˜¬ë¦¼).\n3. summary: ë§í¬ì˜ ë‚´ìš©ì„ í•œ ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½.\n4. response_msg: ì‚¬ìš©ìì—ê²Œ ì¤„ ì¹œì ˆí•œ ì¹­ì°¬ ë©”ì‹œì§€. week_numberì™€ ì‚¬ìš©ì ì´ë¦„ì„ í¬í•¨í•  ê²ƒ.\n\nê²°ê³¼ê°’ì€ ë°˜ë“œì‹œ JSON í¬ë§·ìœ¼ë¡œë§Œ ì¶œë ¥í•´.\n{\n  \"platform\": \"LinkedIn\",\n  \"week_number\": 1,\n  \"week_label\": \"1ì£¼ì°¨\",\n  \"summary\": \"n8n ìë™í™” ì‹œìŠ¤í…œ êµ¬ì¶• ê²½í—˜ ê³µìœ \",\n  \"response_msg\": \"âœ… ì„ì •ë‹˜, 1ì£¼ì°¨ ì¸ì¦ ì™„ë£Œ! ğŸ‰\"\n}"
        }
      },
      "id": "node_ai_agent",
      "name": "AI Agent (URL ë¶„ì„)",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1,
      "position": [680, 300],
      "credentials": {
        "openAiApi": { "id": "REPLACE_WITH_CREDENTIAL_ID", "name": "OpenAI" }
      }
    },
    {
      "parameters": {
        "jsCode": "const raw = $input.first().json.output || $input.first().json.text || '';\nconst jsonMatch = raw.match(/\\{[\\s\\S]*\\}/);\nif (!jsonMatch) throw new Error('AI ì‘ë‹µì—ì„œ JSONì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ' + raw);\nconst parsed = JSON.parse(jsonMatch[0]);\nconst discordData = $('Discord Trigger (ì±Œë¦°ì§€-ì¸ì¦ ì±„ë„)').first().json;\nreturn [{\n  json: {\n    date: new Date().toISOString().split('T')[0],\n    name: discordData.author?.username || 'Unknown',\n    platform: parsed.platform,\n    url: (discordData.content.match(/https?:\\/\\/[^\\s]+/) || [''])[0],\n    week: parsed.week_label,\n    summary: parsed.summary,\n    response_msg: parsed.response_msg,\n    channel_id: discordData.channel_id\n  }\n}];"
      },
      "id": "node_parse_json",
      "name": "AI ì‘ë‹µ íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 300]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": { "__rl": true, "value": "={{$env.GOOGLE_SHEET_ID}}", "mode": "id" },
        "sheetName": { "__rl": true, "value": "Challenge_Log", "mode": "name" },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "ë‚ ì§œ (Date)": "={{ $json.date }}",
            "ì‘ì„±ì (Name)": "={{ $json.name }}",
            "í”Œë«í¼ (Platform)": "={{ $json.platform }}",
            "ì½˜í…ì¸  ë§í¬ (URL)": "={{ $json.url }}",
            "íšŒì°¨ (Week)": "={{ $json.week }}",
            "ì½˜í…ì¸  ìš”ì•½ (Summary)": "={{ $json.summary }}"
          }
        }
      },
      "id": "node_google_sheets",
      "name": "Google Sheets ì €ì¥",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [1120, 300],
      "credentials": {
        "googleSheetsOAuth2Api": { "id": "REPLACE_WITH_CREDENTIAL_ID", "name": "Google Sheets" }
      }
    },
    {
      "parameters": {
        "content": "={{ $('AI ì‘ë‹µ íŒŒì‹±').first().json.response_msg }}",
        "channelId": "={{ $('AI ì‘ë‹µ íŒŒì‹±').first().json.channel_id }}"
      },
      "id": "node_discord_reply",
      "name": "Discord ì¸ì¦ ì™„ë£Œ ë©”ì‹œì§€",
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [1340, 300],
      "credentials": {
        "discordApi": { "id": "REPLACE_WITH_CREDENTIAL_ID", "name": "Discord Bot" }
      }
    }
  ],
  "connections": {
    "Discord Trigger (ì±Œë¦°ì§€-ì¸ì¦ ì±„ë„)": {
      "main": [[ { "node": "URL í¬í•¨ ì—¬ë¶€ í™•ì¸", "type": "main", "index": 0 } ]]
    },
    "URL í¬í•¨ ì—¬ë¶€ í™•ì¸": {
      "main": [
        [ { "node": "AI Agent (URL ë¶„ì„)", "type": "main", "index": 0 } ],
        [ { "node": "URL ì—†ìŒ ì•ˆë‚´ ë©”ì‹œì§€", "type": "main", "index": 0 } ]
      ]
    },
    "AI Agent (URL ë¶„ì„)": {
      "main": [[ { "node": "AI ì‘ë‹µ íŒŒì‹±", "type": "main", "index": 0 } ]]
    },
    "AI ì‘ë‹µ íŒŒì‹±": {
      "main": [[ { "node": "Google Sheets ì €ì¥", "type": "main", "index": 0 } ]]
    },
    "Google Sheets ì €ì¥": {
      "main": [[ { "node": "Discord ì¸ì¦ ì™„ë£Œ ë©”ì‹œì§€", "type": "main", "index": 0 } ]]
    }
  },
  "settings": { "executionOrder": "v1" },
  "_meta": {
    "instanceId": "REPLACE_WITH_YOUR_N8N_INSTANCE_ID"
  }
}
